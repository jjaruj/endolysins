\chapter{Available tools}

\label{kap:avtools} % id kapitoly pre prikaz ref
\paragraph*{}
Since research on phages is largely neglected, there are not many tools designed for phage annotation. When the analysis of phage DNA is required, many companies either execute the analysis manually by using individual bioinformatic tools, or use a tool not designed for phage anotation. In this chapter, we introduce some tools used not designed for phage annotation as well as some recent tools purpose-build for this task. We also explain main differences between our approach and the tools mentioned.
\section{multiPhATE}
\paragraph*{}
One of the most recent tools for phage annotation is multiPhATE \cite{10.1093/bioinformatics/btz258}. It is a high-throughput pipeline driver invoking PhATE annotation pipeline, allowing annotation of a specified set of phage genomes. PhATE uses up to four gene callers: GeneMarkS, Glimmer, Prodigal and Phanotate with Phanotate being developed most recently and more optimized for use with phage genomes \cite{10.1093/bioinformatics/btz265}.
As input, multiPhATE uses a configuration file with a list of genomes for PhATE and a set of parameters controlling software execution. The user specifies the names of files in fasta format containing phage genome, output directories, and other data required for genome analysis. The user can also specify some optional analyses.
\paragraph*{}
For each genome, PhATE begins by using gene callers previously specified by user to perform gene calling. In case of multiple gene callers being used, PhATEs output is a table containing side-by-side comparisons of the gene calls as well as numbers and lengths of gene calls for each algorithm. It also includes numbers of common and unique calls to each algorithm. 
\paragraph*{}
After the gene calling, PhATE uses blastn (nucleotide databases search), blastp (protein databases search) and jackhmmer to identify similarities to the phage genome and predict its gene and peptide sequences using multiple databases: National Center of Biological Information (NCBI) virus genomes, Refseq proteins, refseq genes, virus proteins and Non-Redundant protein sequence database, Swissprot, Phage Annotation Tools and Methods, Kyoto Encyclopedia of Genes and Genomes and a fasta sequence dataset derived from the database of phage Virus Orthologous Groups(pVOG).
\paragraph*{}
The output of PhATE includes: output from gene call algorithms, gene and translated peptide files in fasta format, combined-annotation summary files, raw Blast and HMM outputs, fasta files containing predicted peptides and the members of identified pVOG families where the peptide may be assigned. Using multiPhATE results in all genomes being annotated.
\paragraph*{}
Our pipeline in large part emulates this behaviour, however there are some differences.While multiPhATE uses phage genomes as an input, our tool uses raw reads from the sequencer, making it more specific to the data assemblies are from. Unlike multiPhATE, our tool does not require entire genime for its operation. We have also prioritized locating possible endolysin sequences as opposed to annotating the entire genome. This means that while results from multiPhATE need to be further analysed to find phage endolysins, our tool outputs endolysins directly. To do this, our tool uses a different database. Our database used in Blast is custom made and only includes known endolysins. Almost all differences between our tool and multiPhATE are caused by our desire to be able to input raw reads from sequencer and recieve a direct output containing endolysins. In simpler terms, we prioritize simplicity of execution to possibly more versatile and precise tool.

\section{RASTtk}
\paragraph*{}
Other tool used for phage annotation is RAST tool kit (RASTtk). It is a modular version of annotation tool RAST designed to allow creation of custom annotation pipelines. Even though RAST itself is designed to work with bacterial and archaeal genomes, using the tool kit gives users the opportunity to create pipelines capable of annotating phage genome using scripts featured in it. During annotation, RASTtk uses the specified scripts to produce data, which is then collected to form whole genome. While the workflow of custom pipelines is highly specific, There exists an abstract layout, the RASTtk pipeline follows.
\paragraph*{}
The pipeline begins by transforming a set of contigs into a file format called Genome Typed Object (GTO). The transformed file is formated as a human readable JSON file. To do this, RASTtk uses a script "rast-create-genome." Following this transformation, each step takes an input GTO and enhances it using another script. This creates a new and enhanced GTO file. These modifications repeat using the scripts specified by the user.
\paragraph*{}
In case of phage annotation, one of the useful features is rast-call-features-prophage-phispy, which can be used to find the section of contigs with phage DNA. This is done by using a tool PhiSpy designed to find prophages in bacterial genomes by combining similarity- and composition-based strategies. Another useful scripts are rast-call-features-CDS-genemark/-glimmer3/-prodigal that use genecallers GeneMarkS, Glimmer or Prodigal to find coding sequences in the contigs. The user can also use different methods to annotate proteins.
\paragraph*{}
After every specified script is finish transforming the input, the resulting GTO file can be exported using rast-export-genome. This script can return the results in different formats, including FASTA, Genbank, feature table, etc.. The output includes all input sequences with features annotated by selected scripts. For phage annotation, these results need to be filtered afterwards to only include sequences containing phage DNA.
\paragraph*{}
Since RASTtk, similarly to default RAST, is designed to work with bacterial and archaeal genomes, many of its scripts are designed to deal with annotation of those types of genomes. For example, every gene caller available in RASTtk is designed to look for genes in bacterial genome. These gene callers are still able to find phage genes, since phages generally use same start and stop codons. However, they are largely incapable of discovering overlapping genes, which can appear in viral genome due to the reduction of its genome. For this purpose, Phanotate used by our tool is better, since it is designed to work specifically with phage genome.
\paragraph*{}
As mentioned with multiPhATE, RASTtk is not designed to work with raw reads from a sequencer, allowing it to recieve input from larger variety of sequencers at a cost of increased complexity. Since the resulting output from RASTtk contains all sequences, not just the requested ones, the output needs to be further modified by removing sequences not fulfilling search criteria. This, again increases complexity of the annotation process.